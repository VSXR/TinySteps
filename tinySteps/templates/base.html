{% load static %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="TinySteps - Supporting parents with tools and resources for child development">
        
        <title>
            {% block title %}
                TINY STEPS - EVERY STEP MATTERS
            {% endblock title %}
        </title>
        
        <!-- Preload critical assets -->
        <link rel="preload" href="{% static 'res/css/styles.css' %}" as="style">
        <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" as="style">
        
        <!-- CSS files -->
        <link rel="stylesheet" href="{% static 'res/css/styles.css' %}">
        <link rel="icon" href="{% static 'res/img/favicon/favicon.ico' %}" type="image/x-icon">
        <link href="https://cdn.jsdelivr.net/npm/remixicon@4.0.0/fonts/remixicon.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    </head>

    <body>
        <!-- Skip to main content link for keyboard users -->
        <a href="#main-content" class="skip-link visually-hidden">Skip to main content</a>

        <!-- HEADER (WITH NAVBAR) -->
        <header>
            <nav class="navbar navbar-expand-lg navbar-dark" aria-label="Main Navigation">
                <div class="container-fluid">
                    <!-- Logo and Site Name -->
                    <div class="logo-container d-flex align-items-center">
                        <a class="navbar-brand navLogo d-flex align-items-center me-0" href="{% url 'index' %}">
                            <img src="{% static 'res/img/logo/tabler--north-star.png' %}" alt="Tiny Steps Logo" width="30" height="30">
                        </a>
                        <a class="navbar-brand navName ms-2" href="{% url 'index' %}" aria-label="Tiny Steps Home">Tiny Steps</a>
                    </div>
                    
                    <!-- Mobile Navigation Toggle -->
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                        data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" 
                        aria-expanded="false" aria-label="Toggle navigation menu">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <!-- Navigation Menu -->
                    <div class="navbar-collapse collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav mb-2 mb-lg-0 me-auto">
                            <!-- Main Navigation Links -->
                            <li class="nav-item">
                                <a href="{% url 'your_children' %}" class="nav-link {% if request.resolver_match.url_name == 'your_children' %}active{% endif %}">
                                    <i class="fa-solid fa-baby" aria-hidden="true"></i>
                                    <span class="nav-text">YOUR CHILDREN</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="{% url 'parents_forum' %}" class="nav-link {% if request.resolver_match.url_name == 'parents_forum' %}active{% endif %}">
                                    <i class="fa-solid fa-comments" aria-hidden="true"></i> 
                                    <span class="nav-text">PARENTS FORUM</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="{% url 'guides' %}" class="nav-link {% if 'guides' in request.path %}active{% endif %}">
                                    <i class="fa-solid fa-book" aria-hidden="true"></i> 
                                    <span class="nav-text">GUIDES</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="{% url 'info_request' %}" class="nav-link {% if request.resolver_match.url_name == 'info_request' %}active{% endif %}">
                                    <i class="fa-solid fa-phone" aria-hidden="true"></i> 
                                    <span class="nav-text">REQUEST INFO</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="{% url 'about' %}" class="nav-link {% if request.resolver_match.url_name == 'about' %}active{% endif %}">
                                    <i class="fa-solid fa-question" aria-hidden="true"></i> 
                                    <span class="nav-text">ABOUT US</span>
                                </a>
                            </li>
                        </ul>

                        <!-- Authentication Links -->
                        <ul class="navbar-nav ms-auto me-2">
                            {% if user.is_authenticated %}
                                <li class="nav-item">
                                    <a class="nav-link {% if request.resolver_match.url_name == 'logout' %}active{% endif %}" href="{% url 'logout' %}">
                                        <i class="fa-solid fa-right-from-bracket" aria-hidden="true"></i> 
                                        <span class="nav-text">Logout</span>
                                    </a>
                                </li>
                            {% else %}
                                <li class="nav-item">
                                    <a class="nav-link {% if request.resolver_match.url_name == 'login' %}active{% endif %}" href="{% url 'login' %}">
                                        <i class="fa-solid fa-right-to-bracket" aria-hidden="true"></i> 
                                        <span class="nav-text">Login</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link {% if request.resolver_match.url_name == 'register' %}active{% endif %}" href="{% url 'register' %}">
                                        <i class="fa-solid fa-user-plus" aria-hidden="true"></i> 
                                        <span class="nav-text">Register</span>
                                    </a>
                                </li>
                            {% endif %}
                        </ul>

                        <!-- Social Links -->
                        <ul class="navbar-nav social-nav">
                            <li class="nav-item social">
                                <a href="https://github.com/VSXR" class="nav-link" target="_blank" rel="noopener noreferrer" aria-label="GitHub Profile">
                                    <i class="fa-brands fa-github" aria-hidden="true"></i>
                                    <span class="visually-hidden">GitHub</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Flash Messages with ARIA roles -->
        {% if messages %}
            <section aria-label="Notifications" class="message-container">
                <ul class="messages" role="alert">
                    {% for message in messages %}
                        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                </ul>
            </section>
        {% endif %}

        <!-- MAIN CONTENT with landmark -->
        <main id="main-content" class="container-fluid mt-4">
            {% block main_contents %} 
                <!-- Contenedor principal -->
                <div class="container-fluid">
                    
                    <!-- CONTENIDO PRINCIPAL -->
                    <div class="mainContent container-fluid">
                        <section class="container mt-4" aria-labelledby="welcome-heading">
                            <div class="row mb-4">
                                <div class="col">
                                    <h1 id="welcome-heading" class="text-center">Welcome to Tiny Steps</h1>
                                    <span class="sr-only">(Every step matters)</span>
                                </div>
                            </div>
                        </section>
                        
                        <section aria-labelledby="about-section">
                            <h2 id="about-section" class="visually-hidden">About Tiny Steps</h2>
                            <div class="specific-paragraphs">
                                <p class="text-center">
                                    TINY STEPS is an app designed for first-time parents, launched in 2025, that offers the best tools to 
                                    support your parenting journey. We provide the most intuitive features and the most reliable information 
                                    to make caring for your baby an easy and enjoyable experience.
                                </p>
                                <div class="image-container">
                                    {% comment %} LOGOTIPO TINY STEPS AQUI! {% endcomment %}
                                    <img src="{% static 'res/img/others/default.jpg' %}" class="imgWeb" 
                                        alt="A parent using the Tiny Steps app with their baby" 
                                        loading="lazy">
                                </div>
                            </div>
                        </section>
                        
                        <!-- Resto de secciones ... -->
                        
                    </div>
                </div>
            {% endblock main_contents %}
        </main>

        <!-- FOOTER with navigation landmark -->
        <footer class="footerContainer sticky-footer mt-auto py-3 text-white">
            <nav aria-label="Footer Navigation">
                <ul class="nav footer-nav justify-content-center border-bottom pb-3">
                    <!-- Footer navigation links with ARIA -->
                    <li class="footer-nav-item">
                        <a href="{% url 'index' %}" class="footer-nav-link" aria-label="Home">
                            <i class="fa-solid fa-house" aria-hidden="true"></i> 
                            <span class="footer-link-text">HOME</span>
                        </a>
                    </li>
                    <li class="footer-nav-item">
                        <a href="{% url 'your_children' %}" class="footer-nav-link" aria-label="Your Children">
                            <i class="fa-solid fa-baby" aria-hidden="true"></i>
                            <span class="footer-link-text">YOUR CHILDREN</span>
                        </a>
                    </li>
                    <li class="footer-nav-item">
                        <a href="{% url 'parents_forum' %}" class="footer-nav-link" aria-label="Parents Forum">
                            <i class="fa-solid fa-comments" aria-hidden="true"></i> 
                            <span class="footer-link-text">PARENTS FORUM</span>
                        </a>
                    </li>
                    <li class="footer-nav-item">
                        <a href="{% url 'guides' %}" class="footer-nav-link" aria-label="Guides">
                            <i class="fa-solid fa-book" aria-hidden="true"></i> 
                            <span class="footer-link-text">GUIDES</span>
                        </a>
                    </li>
                    <li class="footer-nav-item">
                        <a href="{% url 'info_request' %}" class="footer-nav-link" aria-label="Request Information">
                            <i class="fa-solid fa-phone" aria-hidden="true"></i> 
                            <span class="footer-link-text">REQUEST INFO</span>
                        </a>
                    </li>
                    <li class="footer-nav-item">
                        <a href="{% url 'about' %}" class="footer-nav-link" aria-label="About Us">
                            <i class="fa-solid fa-question" aria-hidden="true"></i> 
                            <span class="footer-link-text">ABOUT US</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- Copyright information with semantic markup -->
            <div class="footerAuthorText text-center mt-3">
                <div class="madeContainer">
                    <p><small>&copy; 2025 TinySteps. All rights reserved.</small></p>
                </div>
                <div class="madeContainer">
                    <a href="https://github.com/VSXR" class="madeBy" rel="noopener noreferrer" target="_blank" aria-label="Made by VSXR - Visit GitHub profile">- MADE BY VSXR -</a>
                </div>
            </div>
        </footer>

        <!-- Scripts with defer for performance -->
        <script defer src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script defer src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>

        <!-- Custom scripts -->
        <script>
            // Script to prevent page shifting when navbar toggle is clicked on mobile (Hamburger Menu)
            document.addEventListener('DOMContentLoaded', function() {
                const navbarToggler = document.querySelector('.navbar-toggler');
                if(navbarToggler) {
                    navbarToggler.addEventListener('click', function() {
                        document.body.classList.toggle('navbar-open');
                    });
                }
                
                // Make navbar sticky on scroll, but not when mobile menu is closed
                const header = document.querySelector('header');
                const navbarCollapse = document.getElementById('navbarSupportedContent');
                
                // Function to update sticky state based on scroll position and menu state
                function updateStickyState() {
                    const isMobile = window.innerWidth <= 992;
                    const isMenuOpen = navbarCollapse.classList.contains('show');
                    
                    if (window.scrollY > 0) {
                        // Add sticky class in both desktop and mobile when scrolling
                        header.classList.add('sticky-navbar');
                        
                        // On mobile, adjust body class based on menu state
                        if (isMobile && isMenuOpen) {
                            document.body.classList.add('navbar-open');
                        }
                    } else {
                        // Only remove sticky when at top of page and menu closed (on mobile)
                        if (!isMobile || (isMobile && !isMenuOpen)) {
                            header.classList.remove('sticky-navbar');
                        }
                    }
                }
                
                // Check on scroll, resize, and mobile menu toggle
                window.addEventListener('scroll', updateStickyState);
                document.querySelector('.navbar-toggler').addEventListener('click', function() {
                    setTimeout(updateStickyState, 50);
                });
                window.addEventListener('resize', updateStickyState);
            });
        </script>
    </body>
</html>