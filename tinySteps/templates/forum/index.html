{% extends 'forum/base/forum_base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Parents Forum" %} - {% trans "Tiny Steps" %}{% endblock %}

{% block content %}
    <!-- Forum Posts Section -->
    <section aria-labelledby="forum-posts-heading">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h2 id="forum-posts-heading" class="h3 mb-0">
                {% trans "Discussions" %}
                {% if posts %}<span class="badge bg-secondary rounded-pill ms-2">{{ posts.paginator.count }}</span>{% endif %}
            </h2>
            
            <a href="{% url 'forum:create_post' %}" class="btn btn-primary rounded-pill">
                <i class="fa-solid fa-plus me-1" aria-hidden="true"></i> 
                <span class="d-none d-md-inline">{% trans "New Discussion" %}</span>
                <span class="d-inline d-md-none">{% trans "New" %}</span>
            </a>
        </div>
        
        <!-- Discussions List -->
        <div id="forum-posts-container">
            {% if posts %}
                {% for post in posts %}
                    {% include "forum/components/post_card.html" with post=post %}
                {% endfor %}
                
                <!-- Pagination -->
                {% if posts.paginator.num_pages > 1 %}
                <nav aria-label="{% trans 'Forum post pagination' %}" class="my-4">
                    <ul class="pagination justify-content-center">
                        {% if posts.has_previous %}
                            <li class="page-item">
                                <a class="page-link rounded-pill px-3" href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}page=1" aria-label="{% trans 'First page' %}">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link rounded-pill px-3" href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}page={{ posts.previous_page_number }}" aria-label="{% trans 'Previous page' %}">
                                    <i class="fa-solid fa-chevron-left" aria-hidden="true"></i>
                                </a>
                            </li>
                        {% endif %}
                        
                        <li class="page-item active">
                            <span class="page-link rounded-pill px-3">
                                {% blocktrans with current=posts.number total=posts.paginator.num_pages %}{{ current }} of {{ total }}{% endblocktrans %}
                            </span>
                        </li>
                        
                        {% if posts.has_next %}
                            <li class="page-item">
                                <a class="page-link rounded-pill px-3" href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}page={{ posts.next_page_number }}" aria-label="{% trans 'Next page' %}">
                                    <i class="fa-solid fa-chevron-right" aria-hidden="true"></i>
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link rounded-pill px-3" href="?{% if request.GET.q %}q={{ request.GET.q }}&{% endif %}{% if request.GET.category %}category={{ request.GET.category }}&{% endif %}page={{ posts.paginator.num_pages }}" aria-label="{% trans 'Last page' %}">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        {% endif %}
                    </ul>
                </nav>
                {% endif %}
            {% else %}
                <div class="card border-0 shadow-sm rounded-4 p-4 text-center">
                    <div class="py-4">
                        <i class="fa-solid fa-comments fa-3x text-muted mb-3" aria-hidden="true"></i>
                        <h3 class="h5 mb-3">{% trans "No discussions found" %}</h3>
                        <p class="text-muted mb-3">
                            {% if request.GET.q or request.GET.category %}
                                {% trans "No discussions match your search criteria. Try adjusting your filters or start a new discussion." %}
                            {% else %}
                                {% trans "No discussions have been started yet. Be the first to create a discussion!" %}
                            {% endif %}
                        </p>
                        <a href="{% if request.GET.q or request.GET.category %}{% url 'forum:parent_forum' %}{% else %}{% url 'forum:create_post' %}{% endif %}" class="btn btn-primary rounded-pill px-4">
                            {% if request.GET.q or request.GET.category %}
                                <i class="fa-solid fa-times me-1" aria-hidden="true"></i> {% trans "Clear Filters" %}
                            {% else %}
                                <i class="fa-solid fa-plus me-1" aria-hidden="true"></i> {% trans "Start Discussion" %}
                            {% endif %}
                        </a>
                    </div>
                </div>
            {% endif %}
        </div>
    </section>
    
    <!-- Community Banner -->
    <div class="card border-0 shadow-sm rounded-4 bg-light p-0 mt-4 overflow-hidden">
        <div class="card-body p-4">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h3 class="h4 mb-3">{% trans "Join Our Parenting Community" %}</h3>
                    <p class="mb-4">{% trans "Share your parenting journey, ask questions, and connect with other parents. Your experiences can help others!" %}</p>
                    <div class="d-flex gap-2">
                        <a href="{% url 'forum:create_post' %}" class="btn btn-primary rounded-pill">
                            <i class="fa-solid fa-plus me-1" aria-hidden="true"></i> {% trans "New Discussion" %}
                        </a>
                        <a href="#" class="btn btn-outline-primary rounded-pill">
                            <i class="fa-solid fa-users me-1" aria-hidden="true"></i> {% trans "Join Community" %}
                        </a>
                    </div>
                </div>
                <div class="col-md-4 d-none d-md-block text-center">
                    <div class="position-relative">
                        <div class="text-center p-3 rounded-4 bg-white shadow-sm">
                            <i class="fa-solid fa-users fa-5x text-primary mb-2" aria-hidden="true"></i>
                            <div class="text-muted">{% trans "Connect with parents" %}</div>
                        </div>
                        <i class="fa-solid fa-users-rectangle position-absolute top-0 end-0 text-primary fs-3 m-2" aria-hidden="true"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}

{% block extra_js %}
    {{ block.super }}
    <script src="{% static 'res/javascript/parent_forum.js' %}" type="module"></script>
{% endblock extra_js %}