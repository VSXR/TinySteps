{% load i18n %}

{% if categories %}
<div class="card shadow-sm mb-4">
    <div class="card-header bg-{{ color|default:'light' }}">
        <h3 class="h5 mb-0">{% trans "Categories" %}</h3>
    </div>
    <div class="card-body p-0">
        <div class="list-group list-group-flush">
            <a href="?{% if query %}q={{ query }}&{% endif %}" 
               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center {% if not current_category %}active{% endif %}">
                <span>{% trans "All Categories" %}</span>
                <span class="badge bg-{{ badge_color|default:'secondary' }} rounded-pill">{{ total_count }}</span>
            </a>
            
            {% for cat in categories %}
            <a href="?{% if query %}q={{ query }}&{% endif %}category={{ cat.id }}" 
               class="list-group-item list-group-item-action d-flex justify-content-between align-items-center {% if current_category.id == cat.id %}active{% endif %}">
                <span>{{ cat.name }}</span>
                <span class="badge bg-{{ badge_color|default:'secondary' }} rounded-pill">{{ cat.article_count }}</span>
            </a>
            
            {% if cat.children.all %}
                {% for child in cat.children.all %}
                <a href="?{% if query %}q={{ query }}&{% endif %}category={{ child.id }}" 
                   class="list-group-item list-group-item-action d-flex justify-content-between align-items-center ms-3 border-start border-{{ color|default:'primary' }} {% if current_category.id == child.id %}active{% endif %}">
                    <span>{{ child.name }}</span>
                    <span class="badge bg-{{ badge_color|default:'secondary' }} rounded-pill">{{ child.article_count|default:'0' }}</span>
                </a>
                {% endfor %}
            {% endif %}
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}