{% load static %}
{% load i18n %}
{% load custom_filters %}

<div class="col">
    <article class="card h-100 shadow-sm hover-card border-0 text-center mx-auto" style="max-width: 320px;">
        <div class="position-relative">
            {% if guide.image %}
                <img src="{{ guide.image.url }}" class="card-img-top" loading="lazy" style="height: 160px; object-fit: cover;"
                    alt="{% trans 'Guide image' %}">
            {% else %}
                <img src="{% static 'res/img/others/default.jpg' %}" class="card-img-top" loading="lazy" style="height: 160px; object-fit: cover;"
                    alt="{% trans 'Default guide image' %}">
            {% endif %}
            
            <!-- Badge overlay -->
            <div class="position-absolute top-0 end-0 p-2">
                {% if guide.guide_type == 'parent' %}
                    <span class="badge bg-primary">{% trans "Parenting" %}</span>
                {% else %}
                    <span class="badge bg-success">{% trans "Nutrition" %}</span>
                {% endif %}
                
                {% if guide.expert_reviewed %}
                    <span class="badge bg-info ms-1" data-bs-toggle="tooltip" title="{% trans 'Expert reviewed' %}">
                        <i class="bi bi-patch-check-fill" aria-hidden="true"></i>
                    </span>
                {% endif %}
            </div>
        </div>
        
        <div class="card-body py-3 px-3 d-flex flex-column align-items-center">
            <h2 class="card-title h6 mb-2">{{ guide.title }}</h2>
            
            <p class="card-text small text-muted mb-2 flex-grow-1">
                {{ guide.desc|truncatewords:15 }}
            </p>
            
            <div class="d-flex justify-content-center align-items-center w-100 mt-auto">
                {% if show_author and guide.author %}
                    <small class="text-muted me-2">
                        <i class="bi bi-person-fill me-1" aria-hidden="true"></i>
                        {{ guide.author.get_full_name|default:guide.author.username|truncatechars:15 }}
                    </small>
                {% endif %}
                
                {% if show_date and guide.created_at %}
                    <small class="text-muted">
                        <i class="bi bi-calendar3 me-1" aria-hidden="true"></i>
                        {{ guide.created_at|date:"M d" }}
                    </small>
                {% endif %}
            </div>
        </div>
        
        <div class="card-footer bg-white border-top-0 p-3">
            {% if guide.guide_type == 'nutrition' %}
                <a href="{% url 'nutrition_guide_details' guide.id %}" class="btn btn-sm btn-outline-success w-100">
                    {% trans "Read More" %}
                </a>
            {% else %}
                <a href="{% url 'parent_guide_details' guide.id %}" class="btn btn-sm btn-outline-primary w-100">
                    {% trans "Read More" %}
                </a>
            {% endif %}
        </div>
    </article>
</div>