{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}
    {% trans "Guides & Resources - TINY STEPS" %}
{% endblock %}

{% block main_contents %}
<main id="main-content" class="py-4">
    <div class="container mt-4 mb-5">
        <div class="row mb-5">
            <div class="col-lg-10 col-md-12 mx-auto">
                <h1 class="page-title text-center mb-3" id="guides-title">{% trans "GUIDES" %}</h1>
                <p class="lead text-center mb-4" aria-describedby="guides-title">
                    {% trans "Find advice and recommendations for new parents" %}
                </p>
                <hr class="my-4 w-75 mx-auto">
            </div>
        </div>
    </div>

    {% if request.user.is_authenticated and baby_age %}
    <div class="container mb-5">
        <div class="alert alert-info d-flex flex-column flex-sm-row align-items-center p-4" role="status" aria-label="{% trans 'Personalized content notification' %}">
            <i class="fa-solid fa-baby fa-2x me-sm-4 mb-3 mb-sm-0" aria-hidden="true"></i>
            <div>
                <h2 class="h5 mb-2">{% trans "Personalized Content" %}</h2>
                {% if baby_age < 6 %}
                    <p class="mb-0">{% trans "Showing content for newborns (0-6 months)" %}</p>
                {% elif baby_age < 12 %}
                    <p class="mb-0">{% trans "Showing content for infants (6-12 months)" %}</p>
                {% else %}
                    <p class="mb-0">{% trans "Showing content for toddlers (12+ months)" %}</p>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Guide Categories Section -->
    <section class="container mb-5" aria-labelledby="guide-categories-heading">
        <h2 id="guide-categories-heading" class="visually-hidden">{% trans "Guide Categories" %}</h2>
        <div class="row justify-content-center">
            <div class="col-lg-5 col-md-6 mb-4 px-md-3 px-lg-4">
                <div class="card border-primary h-100 shadow-sm">
                    <div class="card-header bg-primary text-white p-3">
                        <h2 class="h4 mb-0 text-center">{% trans "Parenting Guides" %}</h2>
                    </div>
                    <div class="card-body text-center p-4">
                        <p class="mb-4">{% trans "Advice and tips on raising your child, from sleep routines to discipline and development milestones." %}</p>
                        {% url 'parents_guides' as parents_guides_url %}
                        {% if parents_guides_url %}
                        <a href="{{ parents_guides_url }}" class="btn btn-primary btn-lg">
                            <i class="fa-solid fa-book-open me-2" aria-hidden="true"></i>{% trans "Browse Parenting Guides" %}
                        </a>
                        {% else %}
                        <a href="#" class="btn btn-primary btn-lg">
                            <i class="fa-solid fa-book-open me-2" aria-hidden="true"></i>{% trans "Browse Parenting Guides" %}
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="col-lg-5 col-md-6 mb-4 px-md-3 px-lg-4">
                <div class="card border-success h-100 shadow-sm">
                    <div class="card-header bg-success text-white p-3">
                        <h2 class="h4 mb-0 text-center">{% trans "Nutrition Guides" %}</h2>
                    </div>
                    <div class="card-body text-center p-4">
                        <p class="mb-4">{% trans "Learn about baby nutrition, healthy eating habits, feeding schedules, and food introduction." %}</p>
                        {% url 'nutrition_guides' as nutrition_guides_url %}
                        {% if nutrition_guides_url %}
                        <a href="{{ nutrition_guides_url }}" class="btn btn-success btn-lg">
                            <i class="fa-solid fa-utensils me-2" aria-hidden="true"></i>{% trans "Browse Nutrition Guides" %}
                        </a>
                        {% else %}
                        <a href="#" class="btn btn-success btn-lg">
                            <i class="fa-solid fa-utensils me-2" aria-hidden="true"></i>{% trans "Browse Nutrition Guides" %}
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Age-Specific Recommendations -->
    {% if request.user.is_authenticated and baby_age %}
        <section class="container my-5" aria-labelledby="recommendations-heading">
            <div class="card border-primary">
                <div class="card-header bg-primary text-white p-3" id="recommendations-heading">
                    <h2 class="h4 mb-0 text-center">{% trans "Recommended for Your Child" %}</h2>
                </div>
                <div class="card-body p-4">
                    <div class="row">
                        {% if baby_age < 6 %}
                        <!-- Newborn specific recommendations -->
                        <div class="col-md-6 mb-4">
                            {% url 'nutrition_articles' as nutrition_url %}
                            {% url 'parenting_articles' as parenting_url %}
                            
                            <h3 class="h5 mb-3" id="nutrition-section-newborn">{% trans "Nutrition" %}</h3>
                            <ul class="list-group mb-4" aria-labelledby="nutrition-section-newborn">
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                    <a href="{% if nutrition_url %}{{ nutrition_url }}?topic=breastfeeding{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Breastfeeding Tips" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3 mt-2">
                                    <a href="{% if nutrition_url %}{{ nutrition_url }}?topic=formula{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Formula Feeding Guide" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6 mb-4">
                            <h3 class="h5 mb-3" id="parenting-section-newborn">{% trans "Parenting" %}</h3>
                            <ul class="list-group mb-4" aria-labelledby="parenting-section-newborn">
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                    <a href="{% if parenting_url %}{{ parenting_url }}?topic=newborn{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Newborn Essentials" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3 mt-2">
                                    <a href="{% if parenting_url %}{{ parenting_url }}?topic=sleep{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Sleep Patterns for Newborns" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                            </ul>
                        </div>
                        {% elif baby_age < 12 %}
                        <!-- Safe URL access - same approach for all sections -->
                        {% url 'nutrition_articles' as nutrition_url %}
                        {% url 'parenting_articles' as parenting_url %}
                        
                        <!-- 6-12 months specific recommendations -->
                        <div class="col-md-6 mb-4">
                            <h3 class="h5 mb-3" id="nutrition-section-infant">{% trans "Nutrition" %}</h3>
                            <ul class="list-group mb-4" aria-labelledby="nutrition-section-infant">
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                    <a href="{% if nutrition_url %}{{ nutrition_url }}?topic=solids{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Starting Solid Foods" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3 mt-2">
                                    <a href="{% if nutrition_url %}{{ nutrition_url }}?topic=recipes{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Baby Food Recipes" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6 mb-4">
                            <h3 class="h5 mb-3" id="parenting-section-infant">{% trans "Parenting" %}</h3>
                            <ul class="list-group mb-4" aria-labelledby="parenting-section-infant">
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                    <a href="{% if parenting_url %}{{ parenting_url }}?topic=development{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Development Milestones" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3 mt-2">
                                    <a href="{% if parenting_url %}{{ parenting_url }}?topic=routines{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Establishing Routines" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                            </ul>
                        </div>
                        {% else %}
                        <!-- Safe URL access - same approach for all sections -->
                        {% url 'nutrition_articles' as nutrition_url %}
                        {% url 'parenting_articles' as parenting_url %}
                        
                        <!-- 12+ months specific recommendations -->
                        <div class="col-md-6 mb-4">
                            <h3 class="h5 mb-3" id="nutrition-section-toddler">{% trans "Nutrition" %}</h3>
                            <ul class="list-group mb-4" aria-labelledby="nutrition-section-toddler">
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                    <a href="{% if nutrition_url %}{{ nutrition_url }}?topic=toddler{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Toddler Nutrition" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3 mt-2">
                                    <a href="{% if nutrition_url %}{{ nutrition_url }}?topic=mealtime{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Managing Mealtime Challenges" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6 mb-4">
                            <h3 class="h5 mb-3" id="parenting-section-toddler">{% trans "Parenting" %}</h3>
                            <ul class="list-group mb-4" aria-labelledby="parenting-section-toddler">
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                    <a href="{% if parenting_url %}{{ parenting_url }}?topic=discipline{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Positive Discipline" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center p-3 mt-2">
                                    <a href="{% if parenting_url %}{{ parenting_url }}?topic=development{% else %}#{% endif %}" class="text-decoration-none flex-grow-1">
                                        {% trans "Language Development" %}
                                    </a>
                                    <span class="badge bg-primary rounded-pill ms-2" aria-hidden="true">
                                        <i class="fa-solid fa-star"></i>
                                    </span>
                                </li>
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </section>
    {% endif %}

    <!-- Featured Tools Section -->
    <section class="container my-5" aria-labelledby="tools-heading">
        <h2 class="h3 text-center mb-4" id="tools-heading">{% trans "Featured Tools" %}</h2>
        <div class="row justify-content-center">
            <div class="col-lg-5 col-md-6 mb-4 px-md-3 px-lg-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="fa-solid fa-calculator display-4 text-primary mb-4" aria-hidden="true"></i>
                        <h3 class="h5 mb-3">{% trans "Baby Food Nutrition Analyzer" %}</h3>
                        <p class="mb-4">{% trans "Analyze the nutritional content of baby foods and ingredients to ensure your baby gets the right nutrients." %}</p>
                        {% url 'nutrition_analyzer' as analyzer_url %}
                        <a href="{% firstof analyzer_url '#' %}" class="btn btn-success btn-lg mt-auto" aria-label="{% trans 'Try Baby Food Nutrition Analyzer' %}">
                            <i class="fa-solid fa-flask me-2" aria-hidden="true"></i>{% trans "Try It Now" %}
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-lg-5 col-md-6 mb-4 px-md-3 px-lg-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body text-center p-4">
                        <i class="fa-solid fa-clipboard-check display-4 text-primary mb-4" aria-hidden="true"></i>
                        <h3 class="h5 mb-3">{% trans "Milestone Tracker" %}</h3>
                        <p class="mb-4">{% trans "Keep track of your baby's development milestones and celebrate their progress together." %}</p>
                        {% url 'milestone_add' as milestone_url %}
                        <a href="{% firstof milestone_url view.milestone_url '#' %}" class="btn btn-primary btn-lg mt-auto" aria-label="{% trans 'Use Milestone Tracker' %}">
                            <i class="fa-solid fa-plus me-2" aria-hidden="true"></i>{% trans "Track Milestones" %}
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Contribute Banner -->
    <section class="container my-5" aria-labelledby="contribute-heading">
        <div class="card bg-light">
            <div class="card-body p-5 text-center">
                <h2 class="h4 mb-3" id="contribute-heading">{% trans "Share Your Knowledge with Other Parents" %}</h2>
                <p class="mb-4">{% trans "Help the TinySteps community grow by sharing your experiences and tips." %}</p>
                {% url 'submit_guide' as submit_url %}
                {% if submit_url %}
                <div class="d-flex flex-column flex-sm-row justify-content-center gap-3">
                    <a href="{{ submit_url }}?type=parent" class="btn btn-primary btn-lg" aria-label="{% trans 'Submit a parenting guide' %}">
                        <i class="fa-solid fa-plus me-2" aria-hidden="true"></i>{% trans "Submit Parent Guide" %}
                    </a>
                    <a href="{{ submit_url }}?type=nutrition" class="btn btn-success btn-lg" aria-label="{% trans 'Submit a nutrition guide' %}">
                        <i class="fa-solid fa-plus me-2" aria-hidden="true"></i>{% trans "Submit Nutrition Guide" %}
                    </a>
                </div>
                {% else %}
                <div class="d-flex flex-column flex-sm-row justify-content-center gap-3">
                    <a href="#" class="btn btn-primary btn-lg" aria-label="{% trans 'Submit a parenting guide' %}">
                        <i class="fa-solid fa-plus me-2" aria-hidden="true"></i>{% trans "Submit Parent Guide" %}
                    </a>
                    <a href="#" class="btn btn-success btn-lg" aria-label="{% trans 'Submit a nutrition guide' %}">
                        <i class="fa-solid fa-plus me-2" aria-hidden="true"></i>{% trans "Submit Nutrition Guide" %}
                    </a>
                </div>
                {% endif %}
            </div>
        </div>
    </section>
</main>
{% endblock main_contents %}